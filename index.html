<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Bouffe</title>
</head>

<body>
  <h1>List</h1>

  <?php
  $p = dirname(__FILE__);

  $recipes_dir = "$p/src/";
  //print("$recipes_dir");
  foreach (new DirectoryIterator("$recipes_dir") as $fileInfo)
  {
    if ($fileInfo->isDot())
      continue;

    $path='/generated/' . $fileInfo->getFilename();
    echo "<a href=" . $path . ">" . $fileInfo->getFilename() . "</a>";
    echo "<br/>";
  }

  $db_file = "$p/db/db";
  $db = new SQLite3("$db_file");

  $query = "SELECT * FROM recipes;";
  $array['dbhandle'] = $db;
  $array['query'] = "$query";
  $result = $db->query($query);
  while ($row = $result->fetchArray())
  {
    $query_name = "SELECT name FROM words WHERE id={$row['id_word']};";
    $array['dbhandle'] = $db;
    $array['query'] = "$query_name";
    $recipe_name = $db->querySingle($query_name);
    echo "<a href=/pages/recipe.php?id={$row['id']}>" . "$recipe_name" . "</a><br/>";
  }

  ?>

  <h3><a href=srv/add_recipe.php>Add a recipe</a><h3>
</body>
</html>
