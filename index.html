<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Bouffe</title>

  <?php
   session_start();
    if (!isset($_SESSION["language"]))
    {
      $_SESSION["language"] = "1";
    }
 ?>
</head>

<body>
  <?php
    include "srv/helper.php";
  ?>

  <form method="post" action="srv/switch_language.php">
    <input type="submit" name="language" value="English">
    <input type="submit" name="language" value="Deutsch">
    <input type="submit" name="language" value="FranÃ§ais">
  </form>



  <?php
  $p = dirname(__FILE__);

  $db_file = "$p/db/db";
  $db = new SQLite3("$db_file");

  $h = new Helper($db_file);

  echo("<h1>" . $h->fetchWord("Recipes") . "</h1>");

  $recipes_dir = "$p/src/";
  foreach (new DirectoryIterator("$recipes_dir") as $fileInfo)
  {
    if ($fileInfo->isDot())
      continue;

    $path='/generated/' . $fileInfo->getFilename();
    echo "<a href=" . $path . ">" . $fileInfo->getFilename() . "</a>";
    echo "<br/>";
  }

  $query = "SELECT * FROM recipes;";
  $array['dbhandle'] = $db;
  $array['query'] = "$query";
  $result = $db->query($query);
  while ($row = $result->fetchArray())
  {
    $query_name = "SELECT name FROM words WHERE id={$row['id_word']};";
    $array['dbhandle'] = $db;
    $array['query'] = "$query_name";
    $recipe_name = $db->querySingle($query_name);
    echo "<a href=/srv/recipe.php?id={$row['id']}>" . "$recipe_name" . "</a><br/>";
  }

  ?>

  <h3><a href=srv/add_recipe.php>Add a recipe</a></h3>
</body>
</html>
